function Tgas = Tgas(y,Ds,rpm)  % ropi logo kaysis
B = 0.5;     % bore (m)

load =[25,50,75,100];
w =[62.4,78.6,89.9,99]; % RPM gia 25,50,75,100% load
for i=1:length(w)
    p_load(:,i) = p_interpol(y,load(i));
end
for i=1:length(w)-1
    if rpm>=w(i) && rpm<w(i+1)
        p_load_final = (w(i+1)-rpm)/(w(i+1)-w(i))*p_load(:,i)+(-w(i)+rpm)/(w(i+1)-w(i))*p_load(:,i+1);
        break
    elseif i==1 && rpm<w(1)
        p_load_final =p_load(:,1);
        break
    end
end
%Tgas=P;  (mono gia plot kateutheian tin piesi)
Tgas = - Ds*(pi/4)*(B^2)*p_load_final;  % eksisosi ropis logo kaysis (epeksigisi sto main gia to "-")

%if time<t_metabolis
%    if load1==25
%        Tgas=Tgas25(y,Ds);
%    elseif load1 ==50
%        Tgas=Tgas50(y,Ds);
%    elseif load1 ==75
%        Tgas=Tgas75(y,Ds);
%    else
%        Tgas=Tgas100(y,Ds);
%    end
%else
%    if load2==25
%        Tgas=Tgas25(y,Ds);
%    elseif load2 ==50
%        Tgas=Tgas50(y,Ds);
%    elseif load2 ==75
%        Tgas=Tgas75(y,Ds);
%    else
%        Tgas=Tgas100(y,Ds);
%    end
%end

end

